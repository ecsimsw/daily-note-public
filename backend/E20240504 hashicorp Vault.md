## E20240504 hashicorp Vault.md

머릿속에 있는 Vault가 좋았던 점 정리

1. 키 자체와 인증부를 나눌 수 있다.
- 사용해야하는 키는 엄청 많은데 각 키를 사용해야하는 사용자마다 각각 만들어 나눠주긴 힘들것이다.
- 그래서 쉽게는 마스터 키 하나를 만들어 팀에서 갖고 있는데, 퇴사자가 발생하면 키를 리셋해야하고 (안하는 경우도 많겠지만),
- 사용자별 키 사용 이력을 로깅하기도 어렵다.
- Vault 는 보관해야하는 키와 인증부를 나눈다.
- 예를 들어 보관해야하는 키는 (깃헙, KV, AWS, Jenkins) 라고 해도 사용자가 각 키 값을 따로 갖는게 아니라 본인의 인증 수단(깃헙 토큰, username-password) 등으로 인증하는 것으로 키를 획득할 수 있다.
- 이렇게되면 사용자는 본인이 사용해야 하는 키 목록과 인증키를 메모장에 나열하는 일은 불필요할 것이다.
- 또 사용자별로 사용 이력을 로깅하기도 쉬워진다.
- 퇴사자가 발생해도 안전하다. 실제 키 값을 건드는게 아니라 그 키의 권한이나 사용자 자체를 삭제하면 그만이다.

2. 동적키 / 유효기간
- Vault로 부터 얻는 키가 매번 같으면 퇴사자 문제가 완벽하게 처리되지 않는다.
- 퇴사자의 권한은 박탈 당했어도 예전에 얻어둔 키를 어딘가에 적어뒀고, 그 키가 변하지 않는다면?
- Vault의 동적키는 키를 원할때 특정 범위의, 특정 기간동안에만 유효한 키를 새로 발급해 생성한다.
- 그리고 이 키는 관리자에 의해 동적으로 제거될 수 있다.
- 예를 들어 Vault AWS 동적 키를 사용한다면 키를 요청했을 때 30분만 사용 가능한, S3의 특정 범위만 접근 가능한 Access key와 Secret key 가 생성되어 반환된다.
- 퇴사자가 이 키를 어딘가에 적어뒀다한들, 해커가 그 값을 채갔다 한들 딱 유효기간 동안만, 관리자가 눈치채지 못한 시점까지만 사용 가능하다.\
- 키 Vendor 마다 다르겠지만 AWS의 경우에는 이 키를 생성할 수 있는 IAM Policy 를 만들고 Vault가 이를 사용하게 된다.

![image](https://github.com/ecsimsw/daily-note-public/assets/46060746/62083fa8-68da-4ccc-b960-b351fca073b0)
