## Kafka partition key, group id.md

### 카프카 producer : partition key
- 분산 처리로 성능 향상
- 서로 다른 파티션에서는 순서를 보장하지 않음 / 하나의 파티션에서는 순서가 보장
- produce 시 키를 지정하는 것으로 지정한 파티션에 저장을 보장할 수 있고, 같은 파티션 내에서는 순서가 보장됨을 이용할 수 있다.
- 예를 들면 userId를 키로 하고 이 키의 해시 값으로 파티션이 결정되면 한 유저 단위로는 카프카 데이터 순서가 보장될 수 있겠다는 것이다.
- 파티션 수보다 컨슈머가 많은 경우, 개수 차이만큼의 컨슈머는 idle 상태를 낭비된다.

### 카프카 consumer : group Id
- 그렇다고 한 컨슈머가 특정 키의 파티션만 읽도록 강제하는 것은 불가능하다.
- 그럼 결국 producer는 key로 데이터를 적재할 파티션을 골라도 여러 컨슈머가 읽는 경우 여러 파티션에서 데이터를 읽기 때문에 순서 보장에 문제가 발생하기 쉽다.
- groupId는 여러 컨슈머가 있는 상황에서 groupId에 해당하는 그룹 컨슈머 중 한 컨슈머만 데이터를 처리할 수 있도록 한다.

## Kafka consumer is not thread safe.
